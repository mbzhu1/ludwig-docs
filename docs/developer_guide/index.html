
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Deep learning toolbox">
      
      
        <link rel="canonical" href="https://ludwig-ai.github.io/ludwig-docs/developer_guide/">
      
      
        <meta name="author" content="Piero Molino">
      
      <link rel="shortcut icon" href="../favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Developer Guide - Ludwig</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f72e892.min.css">
        
          
          
          <meta name="theme-color" content="#757575">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../stylesheets/monokai.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="grey" data-md-color-accent="grey">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#codebase-structure" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://ludwig-ai.github.io/ludwig-docs/" title="Ludwig" class="md-header-nav__button md-logo" aria-label="Ludwig">
      
<img alt="logo" src="../images/ludwig_logo.svg"
     style="height:1rem;width:4rem;">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Ludwig
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Developer Guide
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/uber/ludwig/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    uber/ludwig
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav aria-label="Navigation" class="md-nav md-nav--primary"
     data-md-level="0">
    <label class="md-nav__title" for="__drawer">
        <a aria-label="Ludwig" class="md-nav__button md-logo"
           href="https://ludwig-ai.github.io/ludwig-docs/"
           title="Ludwig">
            <img alt="logo" src="../images/ludwig_logo.svg"
                 style="width:10rem;height:auto;">
        </a>
    </label>
    
    <div class="md-nav__source">
        
<a href="https://github.com/uber/ludwig/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    uber/ludwig
  </div>
</a>
    </div>
    
    <ul class="md-nav__list" data-md-scrollfix>
        
        
        
        


  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      About
    </a>
  </li>

        
        
        
        


  <li class="md-nav__item">
    <a href="../getting_started/" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
        
        
        


  <li class="md-nav__item">
    <a href="../examples/" class="md-nav__link">
      Examples
    </a>
  </li>

        
        
        
        


  <li class="md-nav__item">
    <a href="../user_guide/" class="md-nav__link">
      User Guide
    </a>
  </li>

        
        
        
        

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Developer Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Developer Guide
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#codebase-structure" class="md-nav__link">
    Codebase Structure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-an-encoder" class="md-nav__link">
    Adding an Encoder
  </a>
  
    <nav class="md-nav" aria-label="Adding an Encoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-new-encoder-class" class="md-nav__link">
    1. Add a new encoder class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-the-new-encoder-class-to-the-corresponding-encoder-registry" class="md-nav__link">
    2. Add the new encoder class to the corresponding encoder registry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-a-decoder" class="md-nav__link">
    Adding a Decoder
  </a>
  
    <nav class="md-nav" aria-label="Adding a Decoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-new-decoder-class" class="md-nav__link">
    1. Add a new decoder class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-the-new-decoder-class-to-the-corresponding-decoder-registry" class="md-nav__link">
    2. Add the new decoder class to the corresponding decoder registry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-a-new-feature-type" class="md-nav__link">
    Adding a new Feature Type
  </a>
  
    <nav class="md-nav" aria-label="Adding a new Feature Type">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-new-feature-class" class="md-nav__link">
    1. Add a new feature class
  </a>
  
    <nav class="md-nav" aria-label="1. Add a new feature class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-features" class="md-nav__link">
    Input features
  </a>
  
    <nav class="md-nav" aria-label="Input features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init__" class="md-nav__link">
    __init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call" class="md-nav__link">
    call
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-features" class="md-nav__link">
    Output features
  </a>
  
    <nav class="md-nav" aria-label="Output features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init___1" class="md-nav__link">
    __init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logits" class="md-nav__link">
    logits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predictions" class="md-nav__link">
    predictions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-the-new-feature-class-to-the-corresponding-feature-registry" class="md-nav__link">
    2. Add the new feature class to the corresponding feature registry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hyper-parameter-optimization" class="md-nav__link">
    Hyper-parameter optimization
  </a>
  
    <nav class="md-nav" aria-label="Hyper-parameter optimization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-a-hyperoptsampler" class="md-nav__link">
    Adding a HyperoptSampler
  </a>
  
    <nav class="md-nav" aria-label="Adding a HyperoptSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-new-sampler-class" class="md-nav__link">
    1. Add a new sampler class
  </a>
  
    <nav class="md-nav" aria-label="1. Add a new sampler class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init___2" class="md-nav__link">
    __init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample" class="md-nav__link">
    sample
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample_batch" class="md-nav__link">
    sample_batch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_batch" class="md-nav__link">
    update_batch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finished" class="md-nav__link">
    finished
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-the-new-sampler-class-to-the-corresponding-sampler-registry" class="md-nav__link">
    2. Add the new sampler class to the corresponding sampler registry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-a-hyperoptexecutor" class="md-nav__link">
    Adding a HyperoptExecutor
  </a>
  
    <nav class="md-nav" aria-label="Adding a HyperoptExecutor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-new-executor-class" class="md-nav__link">
    1. Add a new executor class
  </a>
  
    <nav class="md-nav" aria-label="1. Add a new executor class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init___3" class="md-nav__link">
    __init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute" class="md-nav__link">
    execute
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-the-new-executor-class-to-the-corresponding-executor-registry" class="md-nav__link">
    2. Add the new executor class to the corresponding executor registry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-a-new-integration" class="md-nav__link">
    Adding a new Integration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#style-guidelines" class="md-nav__link">
    Style Guidelines
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests" class="md-nav__link">
    Tests
  </a>
  
    <nav class="md-nav" aria-label="Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checklist" class="md-nav__link">
    Checklist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-tests" class="md-nav__link">
    Running tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
        
        
        


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      API
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="API" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/LudwigModel/" class="md-nav__link">
      LudwigModel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api/visualization/" class="md-nav__link">
      Visualization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
        
        
        


  <li class="md-nav__item">
    <a href="../community/" class="md-nav__link">
      Community
    </a>
  </li>

        
        
        
        


  <li class="md-nav__item">
    <a href="../faq/" class="md-nav__link">
      FAQ
    </a>
  </li>

        
    </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#codebase-structure" class="md-nav__link">
    Codebase Structure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-an-encoder" class="md-nav__link">
    Adding an Encoder
  </a>
  
    <nav class="md-nav" aria-label="Adding an Encoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-new-encoder-class" class="md-nav__link">
    1. Add a new encoder class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-the-new-encoder-class-to-the-corresponding-encoder-registry" class="md-nav__link">
    2. Add the new encoder class to the corresponding encoder registry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-a-decoder" class="md-nav__link">
    Adding a Decoder
  </a>
  
    <nav class="md-nav" aria-label="Adding a Decoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-new-decoder-class" class="md-nav__link">
    1. Add a new decoder class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-the-new-decoder-class-to-the-corresponding-decoder-registry" class="md-nav__link">
    2. Add the new decoder class to the corresponding decoder registry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-a-new-feature-type" class="md-nav__link">
    Adding a new Feature Type
  </a>
  
    <nav class="md-nav" aria-label="Adding a new Feature Type">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-new-feature-class" class="md-nav__link">
    1. Add a new feature class
  </a>
  
    <nav class="md-nav" aria-label="1. Add a new feature class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-features" class="md-nav__link">
    Input features
  </a>
  
    <nav class="md-nav" aria-label="Input features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init__" class="md-nav__link">
    __init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call" class="md-nav__link">
    call
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-features" class="md-nav__link">
    Output features
  </a>
  
    <nav class="md-nav" aria-label="Output features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init___1" class="md-nav__link">
    __init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logits" class="md-nav__link">
    logits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predictions" class="md-nav__link">
    predictions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-the-new-feature-class-to-the-corresponding-feature-registry" class="md-nav__link">
    2. Add the new feature class to the corresponding feature registry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hyper-parameter-optimization" class="md-nav__link">
    Hyper-parameter optimization
  </a>
  
    <nav class="md-nav" aria-label="Hyper-parameter optimization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-a-hyperoptsampler" class="md-nav__link">
    Adding a HyperoptSampler
  </a>
  
    <nav class="md-nav" aria-label="Adding a HyperoptSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-new-sampler-class" class="md-nav__link">
    1. Add a new sampler class
  </a>
  
    <nav class="md-nav" aria-label="1. Add a new sampler class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init___2" class="md-nav__link">
    __init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample" class="md-nav__link">
    sample
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample_batch" class="md-nav__link">
    sample_batch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update" class="md-nav__link">
    update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_batch" class="md-nav__link">
    update_batch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finished" class="md-nav__link">
    finished
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-the-new-sampler-class-to-the-corresponding-sampler-registry" class="md-nav__link">
    2. Add the new sampler class to the corresponding sampler registry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-a-hyperoptexecutor" class="md-nav__link">
    Adding a HyperoptExecutor
  </a>
  
    <nav class="md-nav" aria-label="Adding a HyperoptExecutor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-a-new-executor-class" class="md-nav__link">
    1. Add a new executor class
  </a>
  
    <nav class="md-nav" aria-label="1. Add a new executor class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init___3" class="md-nav__link">
    __init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execute" class="md-nav__link">
    execute
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-the-new-executor-class-to-the-corresponding-executor-registry" class="md-nav__link">
    2. Add the new executor class to the corresponding executor registry
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-a-new-integration" class="md-nav__link">
    Adding a new Integration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#style-guidelines" class="md-nav__link">
    Style Guidelines
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tests" class="md-nav__link">
    Tests
  </a>
  
    <nav class="md-nav" aria-label="Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checklist" class="md-nav__link">
    Checklist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-tests" class="md-nav__link">
    Running tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/uber/ludwig/edit/master/mkdocs/docs/developer_guide.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Developer Guide</h1>
                
                <h2 id="codebase-structure">Codebase Structure<a class="headerlink" href="#codebase-structure" title="Permanent link">&para;</a></h2>
<p>The codebase is organized in a modular, datatype / feature centric way so that adding a feature for a new datatype is pretty straightforward and requires isolated code changes.
All the datatype specific logic lives in the corresponding feature module, all of which are under <code>ludwig/features/</code>.</p>
<p>Feature classes contain raw data preprocessing logic specific to each data type in datatype mixin clases, like <code>BinaryFeatureMixin</code>, <code>NumericalFeatureMixin</code>, <code>CategoryFeatureMixin</code>, and so on.
Those classes contain data preprocessing functions to obtain feature metadata (<code>get_feature_meta</code>, one-time dataset-wide operation to collect things like min, max, average, vocabularies, etc.) and to transform raw data into tensors using the previously calculated metadata (<code>add_feature_data</code>, which usually work on a a dataset row basis).
Output features also contain datatype-specific logic to compute data postprocessing, to transform model predictions back into data space, and output metrics such as loss, accuracy, etc..</p>
<p>Encoders and decoders are modularized as well (they are under <code>ludwig/encoders</code> and <code>ludwig/decoders</code> respectively) so that they can be used by multiple features.
For example sequence encoders are shared among text, sequence, and timeseries features.</p>
<p>Various model architecture components which can be reused are also split into dedicated modules, for example convolutional modules, fully connected modules, etc.. which are available in <code>ludwig/modules</code>.</p>
<p>The training logic resides in <code>ludwig/models/trainer.py</code> which initializes a training session, feeds the data, and executes training.
The prediction logic resides in <code>ludwig/models/predictior.py</code> instead.</p>
<p>The command line interface is managet by the <code>ludwig/cli.py</code> script, which imports the various scripts in <code>ludwig/</code> that perform the different command line commands.</p>
<p>The programmatic interface (which is also used by the CLI commands) is available in the <code>ludwig/api.py</code> script.</p>
<p>Hyper-parameter optimization logic is implemented in the scripts in the <code>ludwig/hyperopt</code> package. </p>
<p>The <code>ludwig/utils</code> package contains various utilities used by all other packages.</p>
<p>Finally the <code>ludwig/contrib</code> packages contains user contributed code that integrates with external libraries.</p>
<h2 id="adding-an-encoder">Adding an Encoder<a class="headerlink" href="#adding-an-encoder" title="Permanent link">&para;</a></h2>
<h3 id="1-add-a-new-encoder-class">1. Add a new encoder class<a class="headerlink" href="#1-add-a-new-encoder-class" title="Permanent link">&para;</a></h3>
<p>Source code for encoders lives under <code>ludwig/encoders</code>.
New encoder objects should be defined in the corresponding files, for example all new sequence encoders should be added to <code>ludwig/encoders/sequence_encoders.py</code>.</p>
<p>All the encoder parameters should be provided as arguments in the constructor with their default values set.
For example the <code>StackedRNN</code> encoder takes the following list of arguments in its constructor:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">should_embed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">vocab</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">representation</span><span class="o">=</span><span class="s1">&#39;dense&#39;</span><span class="p">,</span>
    <span class="n">embedding_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">embeddings_trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">pretrained_embeddings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">embeddings_on_cpu</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">num_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">state_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">cell_type</span><span class="o">=</span><span class="s1">&#39;rnn&#39;</span><span class="p">,</span>
    <span class="n">bidirectional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;tanh&#39;</span><span class="p">,</span>
    <span class="n">recurrent_activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">,</span>
    <span class="n">unit_forget_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">recurrent_initializer</span><span class="o">=</span><span class="s1">&#39;orthogonal&#39;</span><span class="p">,</span>
    <span class="n">recurrent_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">recurrent_dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">fc_layers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">num_fc_layers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">fc_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">weights_initializer</span><span class="o">=</span><span class="s1">&#39;glorot_uniform&#39;</span><span class="p">,</span>
    <span class="n">bias_initializer</span><span class="o">=</span><span class="s1">&#39;zeros&#39;</span><span class="p">,</span>
    <span class="n">weights_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">norm_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fc_activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
    <span class="n">fc_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">reduce_output</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
</code></pre></div>


<p>Typically all the modules the encoder relies upon are initialized in the encoder's constructor (in the case of the <code>StackedRNN</code> encoder these are <code>EmbedSequence</code> and <code>RecurrentStack</code> modules) so that at the end of the constructor call all the layers are fully described.</p>
<p>Actual computation of activations takes place inside the <code>call</code> method of the encoder.
All encoders should have the following signature:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</code></pre></div>


<p><strong>Inputs</strong></p>
<ul>
<li><strong>inputs</strong> (tf.Tensor): input tensor.</li>
<li><strong>training</strong> (bool, default: <code>None</code>): boolean indicating whether we are currently training the model or performing inference for prediction.</li>
<li><strong>mask</strong> (tf.Tensor, default: <code>None</code>): binary tensor indicating which of the values in the inputs tensor should be masked out.</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li><strong>hidden</strong> (tf.Tensor): feature encodings.</li>
</ul>
<p>The shape of the input tensor and the expected tape of the output tensor varies across feature types.</p>
<p>Encoders are initialized as class member variables in input features object constructors and called inside their <code>call</code> methods.</p>
<h3 id="2-add-the-new-encoder-class-to-the-corresponding-encoder-registry">2. Add the new encoder class to the corresponding encoder registry<a class="headerlink" href="#2-add-the-new-encoder-class-to-the-corresponding-encoder-registry" title="Permanent link">&para;</a></h3>
<p>Mapping between encoder names in the model definition and encoder classes in the codebase is done by encoder registries: for example sequence encoder registry is defined in <code>ludwig/features/sequence_feature.py</code> inside the <code>SequenceInputFeature</code> as:</p>
<div class="codehilite"><pre><span></span><code><span class="n">sequence_encoder_registry</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;stacked_cnn&#39;</span><span class="p">:</span> <span class="n">StackedCNN</span><span class="p">,</span>
    <span class="s1">&#39;parallel_cnn&#39;</span><span class="p">:</span> <span class="n">ParallelCNN</span><span class="p">,</span>
    <span class="s1">&#39;stacked_parallel_cnn&#39;</span><span class="p">:</span> <span class="n">StackedParallelCNN</span><span class="p">,</span>
    <span class="s1">&#39;rnn&#39;</span><span class="p">:</span> <span class="n">StackedRNN</span><span class="p">,</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre></div>


<p>All you have to do to make you new encoder available as an option in the model definition is to add it to the appropriate registry.</p>
<h2 id="adding-a-decoder">Adding a Decoder<a class="headerlink" href="#adding-a-decoder" title="Permanent link">&para;</a></h2>
<h3 id="1-add-a-new-decoder-class">1. Add a new decoder class<a class="headerlink" href="#1-add-a-new-decoder-class" title="Permanent link">&para;</a></h3>
<p>Source code for decoders lives under <code>ludwig/decoders/</code>.
New decoder objects should be defined in the corresponding files, for example all new sequence decoders should be added to <code>ludwig/decoders/sequence_decoders.py</code>.</p>
<p>All the decoder parameters should be provided as arguments in the constructor with their default values set.
For example the <code>SequenceGeneratorDecoder</code> decoder takes the following list of arguments in its constructor:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">num_classes</span><span class="p">,</span>
    <span class="n">cell_type</span><span class="o">=</span><span class="s1">&#39;rnn&#39;</span><span class="p">,</span>
    <span class="n">state_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">embedding_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
    <span class="n">beam_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">num_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">attention</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">tied_embeddings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">is_timeseries</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">max_sequence_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">weights_initializer</span><span class="o">=</span><span class="s1">&#39;glorot_uniform&#39;</span><span class="p">,</span>
    <span class="n">bias_initializer</span><span class="o">=</span><span class="s1">&#39;zeros&#39;</span><span class="p">,</span>
    <span class="n">weights_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">reduce_input</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
</code></pre></div>


<p>Decoders are initialized as class member variables in output feature object constructors and called inside <code>call</code> methods.</p>
<h3 id="2-add-the-new-decoder-class-to-the-corresponding-decoder-registry">2. Add the new decoder class to the corresponding decoder registry<a class="headerlink" href="#2-add-the-new-decoder-class-to-the-corresponding-decoder-registry" title="Permanent link">&para;</a></h3>
<p>Mapping between decoder names in the model definition and decoder classes in the codebase is done by encoder registries: for example sequence encoder registry is defined in <code>ludwig/features/sequence_feature.py</code> inside the <code>SequenceOutputFeature</code> as:</p>
<div class="codehilite"><pre><span></span><code><span class="n">sequence_decoder_registry</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="n">Generator</span><span class="p">,</span>
    <span class="s1">&#39;tagger&#39;</span><span class="p">:</span> <span class="n">Tagger</span>
<span class="p">}</span>
</code></pre></div>


<p>All you have to do to make you new decoder available as an option in the model definition is to add it to the appropriate registry.</p>
<h2 id="adding-a-new-feature-type">Adding a new Feature Type<a class="headerlink" href="#adding-a-new-feature-type" title="Permanent link">&para;</a></h2>
<h3 id="1-add-a-new-feature-class">1. Add a new feature class<a class="headerlink" href="#1-add-a-new-feature-class" title="Permanent link">&para;</a></h3>
<p>Souce code for feature classes lives under <code>ludwig/features</code>.
Input and output feature classes are defined in the same file, for example <code>CategoryInputFeature</code> and <code>CategoryOutputFeature</code> are defined in <code>ludwig/features/category_feature.py</code>.</p>
<p>An input features inherit from the <code>InputFeature</code> and corresponding mixin feature classes, for example <code>CategoryInputFeature</code> inherits from <code>CategoryFeatureMixin</code> and <code>InputFeature</code>.</p>
<p>Similarly, output features inherit from the <code>OutputFeature</code> and corresponding base feature classes, for example <code>CategoryOutputFeature</code> inherits from <code>CategoryFeatureMixin</code> and <code>OutputFeature</code>.</p>
<p>Feature parameters are provided in a dictionary of key-value pairs as an argument to the input or output feature constructor which contains default parameter values as well.</p>
<h4 id="input-features">Input features<a class="headerlink" href="#input-features" title="Permanent link">&para;</a></h4>
<p>All input features should implement <code>__init__</code> and <code>call</code> methods with the following signatures:</p>
<h5 id="__init__"><code>__init__</code><a class="headerlink" href="#__init__" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">encoder_obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</code></pre></div>


<p><strong>Inputs</strong></p>
<ul>
<li><strong>feature</strong>: (dict) contains all feature parameters.</li>
<li><strong>encoder_obj</strong>: (*Encoder, default: <code>None</code>) is an encoder object of the type supported (a cateory encoder, binary encoder, etc.). It is used only when two input features share the encoder.</li>
</ul>
<h5 id="call"><code>call</code><a class="headerlink" href="#call" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</code></pre></div>


<p><strong>Inputs</strong></p>
<ul>
<li><strong>inputs</strong> (tf.Tensor): input tensor.</li>
<li><strong>training</strong> (bool, default: <code>None</code>): boolean indicating whether we are currently training the model or performing inference for prediction.</li>
<li><strong>mask</strong> (tf.Tensor, default: <code>None</code>): binary tensor indicating which of the values in the inputs tensor should be masked out.</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li><strong>hidden</strong> (tf.Tensor): feature encodings.</li>
</ul>
<h4 id="output-features">Output features<a class="headerlink" href="#output-features" title="Permanent link">&para;</a></h4>
<p>All input features should implement <code>__init__</code>, <code>logits</code> and <code>predictions</code> methods with the following signatures:</p>
<h5 id="__init___1"><code>__init__</code><a class="headerlink" href="#__init___1" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">encoder_obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</code></pre></div>


<p><strong>Inputs</strong></p>
<ul>
<li><strong>feature</strong> (dict): contains all feature parameters.</li>
<li><strong>decoder_obj</strong> (*Decoder, default: <code>None</code>): is a decoder object of the type supported (a cateory decoder, binary decoder, etc.). It is used only when two output features share the decoder.</li>
</ul>
<h5 id="logits"><code>logits</code><a class="headerlink" href="#logits" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</code></pre></div>


<p><strong>Inputs</strong></p>
<ul>
<li><strong>inputs</strong> (dict): input dictionary that is the output of the combiner.</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li><strong>hidden</strong> (tf.Tensor): feature logits.</li>
</ul>
<h5 id="predictions"><code>predictions</code><a class="headerlink" href="#predictions" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</code></pre></div>


<p><strong>Inputs</strong></p>
<ul>
<li><strong>inputs</strong> (dict): input dictionary that contains the output of the combiner and the logits function.</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li><strong>hidden</strong> (dict): contains predictions, probabilities and logits.</li>
</ul>
<h3 id="2-add-the-new-feature-class-to-the-corresponding-feature-registry">2. Add the new feature class to the corresponding feature registry<a class="headerlink" href="#2-add-the-new-feature-class-to-the-corresponding-feature-registry" title="Permanent link">&para;</a></h3>
<p>Input and output feature registries are defined in <code>ludwig/features/feature_registries.py</code>.</p>
<h2 id="hyper-parameter-optimization">Hyper-parameter optimization<a class="headerlink" href="#hyper-parameter-optimization" title="Permanent link">&para;</a></h2>
<p>The hyper-parameter optimization design in Ludwig is based on two abstract interfaces: <code>HyperoptSampler</code> and <code>HyperoptExecutor</code>. </p>
<p><code>HyperoptSampler</code> represents the sampler adopted for sampling hyper-parameters values.
 Which sampler to use is defined in the <code>sampler</code> section of the model definition.
A <code>Sampler</code> uses the <code>parameters</code> defined in the <code>hyperopt</code> section of the YAML model definition and a <code>goal</code> , either to minimize or maximize.
Each sub-class of <code>HyperoptSampler</code> that implements its abstract methods samples parameters according to their definition and type differently (see <a href="../user_guide/#hyper-parameter-optimization">User Guide</a> for details), like using a random search (implemented in <code>RandomSampler</code>), or a grid serach (implemented in <code>GridSampler</code>, or bayesian optimization or evolutionary techniques.</p>
<p><code>HyperoptExecutor</code> represents the method used to execute the hyper-parameter optimization, independently of how the values for the hyperparameters are sampled.
Available implementations are a serial executor that executes the training with the different sampled hyper-parameters values one at a time (implemented in <code>SerialExecutor</code>), a parallel executor that runs the training using sampled hyper-parameters values in parallel on the same machine (implemented in the <code>ParallelExecutor</code>), and a <a href="https://uber.github.io/fiber/">Fiber</a>-based executor that enables to run the training using sampled hyper-parameters values in parallel on multiple machines within a cluster. 
A <code>HyperoptExecutor</code> uses a <code>HyperoptSampler</code> to sample hyper-parameters values, usually initializes an execution context, like a multithread pool for instance, and executes the hyper-parameter optimization according to the sampler.
First, a new batch of parameters values is sampled from the <code>HyperoptSampler</code>.
Then, sampled parameters values are merged with the basic model definition parameters specified, with the sampled parameters values overriding the ones in the basic model definition they refer to.
Training is executed using the merged model definition and training and validation losses and metrics are collected.
A <code>(sampled_parameters, statistics)</code> pair is provided to the <code>HyperoptSampler.update</code> function and the loop is repeated until all the samples are sampled.
At the end, <code>HyperoptExecutor.execute</code> returns a list of dictionaries that include a parameter sample, its metric score, and its training and test statistics.
The returned list is printed and saved to disk, so that it can also be used as input to <a href="../user_guide/#hyper-parameter-optimization-visualization">hyper-parameter optimization visualizations</a>.</p>
<h3 id="adding-a-hyperoptsampler">Adding a HyperoptSampler<a class="headerlink" href="#adding-a-hyperoptsampler" title="Permanent link">&para;</a></h3>
<h4 id="1-add-a-new-sampler-class">1. Add a new sampler class<a class="headerlink" href="#1-add-a-new-sampler-class" title="Permanent link">&para;</a></h4>
<p>The source code for the base <code>HyperoptSampler</code> class is in the <code>ludwig/hyperopt/sampling.py</code> module.
Classes extending the base class should be defined in the same module.</p>
<h5 id="__init___2"><code>__init__</code><a class="headerlink" href="#__init___2" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
</code></pre></div>


<p>The parameters of the base <code>HyperoptStrategy</code> class constructor are:
- <code>goal</code> which indicates if to minimize or maximize a metric or a loss of any of the output features on any of the splits which is defined in the <code>hyperopt</code> section
- <code>parameters</code> which contains all hyper-parameters to optimize with their types and ranges / values.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code><span class="n">goal</span> <span class="o">=</span> <span class="s2">&quot;minimize&quot;</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;training.learning_rate&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span><span class="p">,</span>
        <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
        <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;linear&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;combiner.num_fc_layers&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span><span class="p">,</span>
        <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="mi">3</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">sampler</span> <span class="o">=</span> <span class="n">GridSampler</span><span class="p">(</span><span class="n">goal</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
</code></pre></div>


<h5 id="sample"><code>sample</code><a class="headerlink" href="#sample" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</code></pre></div>


<p><code>sample</code> is a method that yields a new sample according to the sampler.
It returns a set of parameters names and their values.
If <code>finished()</code> returns <code>True</code>, calling <code>sample</code> would return a <code>IndexError</code>.</p>
<p>Example returned value:</p>
<div class="codehilite"><pre><span></span><code>{&#39;training.learning_rate&#39;: 0.005, &#39;combiner.num_fc_layers&#39;: 2, &#39;utterance.cell_type&#39;: &#39;gru&#39;}
</code></pre></div>


<h5 id="sample_batch"><code>sample_batch</code><a class="headerlink" href="#sample_batch" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">sample_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
</code></pre></div>


<p><code>sample_batch</code> method returns a list of sampled parameters of length equal to or less than <code>batch_size</code>.
If <code>finished()</code> returns <code>True</code>, calling <code>sample_batch</code> would return a <code>IndexError</code>. </p>
<p>Example returned value:</p>
<div class="codehilite"><pre><span></span><code>[{&#39;training.learning_rate&#39;: 0.005, &#39;combiner.num_fc_layers&#39;: 2, &#39;utterance.cell_type&#39;: &#39;gru&#39;}, {&#39;training.learning_rate&#39;: 0.015, &#39;combiner.num_fc_layers&#39;: 3, &#39;utterance.cell_type&#39;: &#39;lstm&#39;}]
</code></pre></div>


<h5 id="update"><code>update</code><a class="headerlink" href="#update" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">sampled_parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">metric_score</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">):</span>
</code></pre></div>


<p><code>update</code> updates the sampler with the results of previous computation.
- <code>sampled_parameters</code> is a dictionary of sampled parameters.
- <code>metric_score</code> is the value of the optimization metric obtained for the specified sample.</p>
<p>It is not needed for stateless strategies like grid and random, but is needed for stateful strategies like bayesian and evolutionary ones.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code><span class="n">sampled_parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;training.learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span>
    <span class="s1">&#39;combiner.num_fc_layers&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> 
    <span class="s1">&#39;utterance.cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gru&#39;</span>
<span class="p">}</span> 
<span class="n">metric_score</span> <span class="o">=</span> <span class="mf">2.53463</span>

<span class="n">sampler</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sampled_parameters</span><span class="p">,</span> <span class="n">metric_score</span><span class="p">)</span>
</code></pre></div>


<h5 id="update_batch"><code>update_batch</code><a class="headerlink" href="#update_batch" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_batch</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">parameters_metric_tuples</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="nb">float</span><span class="p">]]</span>
<span class="p">):</span>
</code></pre></div>


<p><code>update_batch</code> updates the sampler with the results of previous computation in batch.
- <code>parameters_metric_tuples</code> a list of pairs of sampled parameters and their respective metric value.</p>
<p>It is not needed for stateless strategies like grid and random, but is needed for stateful strategies like bayesian and evolutionary ones.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code><span class="n">sampled_parameters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s1">&#39;training.learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span>
        <span class="s1">&#39;combiner.num_fc_layers&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> 
        <span class="s1">&#39;utterance.cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gru&#39;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;training.learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.015</span><span class="p">,</span>
        <span class="s1">&#39;combiner.num_fc_layers&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> 
        <span class="s1">&#39;utterance.cell_type&#39;</span><span class="p">:</span> <span class="s1">&#39;lstm&#39;</span>
    <span class="p">}</span>
<span class="p">]</span>
<span class="n">metric_scores</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.53463</span><span class="p">,</span> <span class="mf">1.63869</span><span class="p">]</span>

<span class="n">sampler</span><span class="o">.</span><span class="n">update_batch</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sampled_parameters</span><span class="p">,</span> <span class="n">metric_scores</span><span class="p">))</span>
</code></pre></div>


<h5 id="finished"><code>finished</code><a class="headerlink" href="#finished" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">finished</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</code></pre></div>


<p>The <code>finished</code> method return <code>True</code> when all samples have been sampled, return <code>False</code> otherwise.</p>
<h4 id="2-add-the-new-sampler-class-to-the-corresponding-sampler-registry">2. Add the new sampler class to the corresponding sampler registry<a class="headerlink" href="#2-add-the-new-sampler-class-to-the-corresponding-sampler-registry" title="Permanent link">&para;</a></h4>
<p>The <code>sampler_registry</code> contains a mapping between <code>sampler</code> names in the <code>hyperopt</code> section of model definition and <code>HyperoptSampler</code> sub-classes.
To make a new sampler available, add it to the registry:</p>
<div class="codehilite"><pre><span></span><code>sampler_registry = {
    &quot;random&quot;: RandomSampler,
    &quot;grid&quot;: GridSampler,
    ...,
    &quot;new_sampler_name&quot;: NewSamplerClass
}
</code></pre></div>


<h3 id="adding-a-hyperoptexecutor">Adding a HyperoptExecutor<a class="headerlink" href="#adding-a-hyperoptexecutor" title="Permanent link">&para;</a></h3>
<h4 id="1-add-a-new-executor-class">1. Add a new executor class<a class="headerlink" href="#1-add-a-new-executor-class" title="Permanent link">&para;</a></h4>
<p>The source code for the base <code>HyperoptExecutor</code> class is in the <code>ludwig/utils/hyperopt_utils.py</code> module.
Classes extending the base class should be defined in the module.</p>
<h5 id="__init___3"><code>__init__</code><a class="headerlink" href="#__init___3" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">hyperopt_sampler</span><span class="p">:</span> <span class="n">HyperoptSampler</span><span class="p">,</span>
    <span class="n">output_feature</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">split</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span>
</code></pre></div>


<p>The parameters of the base <code>HyperoptExecutor</code> class constructor are
- <code>hyperopt_sampler</code> is a <code>HyperoptSampler</code> object that will be used to sample hyper-parameters values
- <code>output_feature</code> is a <code>str</code> containing the name of the output feature that we want to optimize the metric or loss of. Available values are <code>combined</code> (default) or the name of any output feature provided in the model definition. <code>combined</code> is a special output feature that allows to optimize for the aggregated loss and metrics of all output features.
- <code>metric</code> is the metric that we want to optimize for. The default one is <code>loss</code>, but depending on the tye of the feature defined in <code>output_feature</code>, different metrics and losses are available. Check the metrics section of the specific output feature type to figure out what metrics are available to use.
- <code>split</code> is the split of data that we want to compute our metric on. By default it is the <code>validation</code> split, but you have the flexibility to specify also <code>train</code> or <code>test</code> splits.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code><span class="n">goal</span> <span class="o">=</span> <span class="s2">&quot;minimize&quot;</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;training.learning_rate&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span><span class="p">,</span>
                <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
                <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;linear&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;combiner.num_fc_layers&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span><span class="p">,</span>
                <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                <span class="s2">&quot;steps&quot;</span><span class="p">:</span> <span class="mi">3</span>
            <span class="p">}</span>
        <span class="p">}</span>
<span class="n">output_feature</span> <span class="o">=</span> <span class="s2">&quot;combined&quot;</span>
<span class="n">metric</span> <span class="o">=</span> <span class="s2">&quot;loss&quot;</span>
<span class="n">split</span> <span class="o">=</span> <span class="s2">&quot;validation&quot;</span>

<span class="n">grid_sampler</span> <span class="o">=</span> <span class="n">GridSampler</span><span class="p">(</span><span class="n">goal</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
<span class="n">executor</span> <span class="o">=</span> <span class="n">SerialExecutor</span><span class="p">(</span><span class="n">grid_sampler</span><span class="p">,</span> <span class="n">output_feature</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">split</span><span class="p">)</span>
</code></pre></div>


<h5 id="execute"><code>execute</code><a class="headerlink" href="#execute" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">config</span><span class="p">,</span>
    <span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">training_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">validation_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">test_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">training_set_metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">data_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">experiment_name</span><span class="o">=</span><span class="s2">&quot;hyperopt&quot;</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;run&quot;</span><span class="p">,</span>
    <span class="n">model_load_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">model_resume_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">skip_save_training_description</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_training_statistics</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_model</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_processed_input</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_unprocessed_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_predictions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_save_eval_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">output_directory</span><span class="o">=</span><span class="s2">&quot;results&quot;</span><span class="p">,</span>
    <span class="n">gpus</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">gpu_memory_limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_parallel_threads</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">use_horovod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="n">default_random_seed</span><span class="p">,</span>
    <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
</code></pre></div>


<p>The <code>execute</code> method executes the hyper-parameter optimization.
It can leverage the <code>run_experiment</code> function to obtain training and eval statistics and the <code>self.get_metric_score</code> function to extract the metric score from the eval results according to <code>self.output_feature</code>, <code>self.metric</code> and <code>self.split</code>.</p>
<h4 id="2-add-the-new-executor-class-to-the-corresponding-executor-registry">2. Add the new executor class to the corresponding executor registry<a class="headerlink" href="#2-add-the-new-executor-class-to-the-corresponding-executor-registry" title="Permanent link">&para;</a></h4>
<p>The <code>executor_registry</code> contains a mapping between <code>executor</code> names in the <code>hyperopt</code> section of model definition and <code>HyperoptExecutor</code> sub-classes.
To make a new executor available, add it to the registry:</p>
<div class="codehilite"><pre><span></span><code>executor_registry = {
    &quot;serial&quot;: SerialExecutor,
    &quot;parallel&quot;: ParallelExecutor,
    &quot;fiber&quot;: FiberExecutor,
    &quot;new_executor_name&quot;: NewExecutorClass
}
</code></pre></div>


<h2 id="adding-a-new-integration">Adding a new Integration<a class="headerlink" href="#adding-a-new-integration" title="Permanent link">&para;</a></h2>
<p>Ludwig provides an open-ended method of third-party system
integration. This makes it easy to integrate other systems or services
with Ludwig without having users do anything other than adding a flag
to the command line interface.</p>
<p>To contribute an integration, follow these steps:</p>
<ol>
<li>Create a Python file in <code>ludwig/contribs/</code> with an obvious name. In this example, it is called <code>mycontrib.py</code>.</li>
<li>Inside that file, create a class with the following structure, renaming <code>MyContribution</code> to a name that is associated with the third-party system:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MyContribution</span><span class="p">():</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">import_call</span><span class="p">(</span><span class="n">argv</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># This is called when your flag is used before any other imports.</span>

    <span class="k">def</span> <span class="nf">experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># See: ludwig/experiment.py and ludwig/cli.py</span>

    <span class="k">def</span> <span class="nf">experiment_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># See: ludwig/experiment.py</span>

    <span class="k">def</span> <span class="nf">train_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiment_directory</span><span class="p">,</span> <span class="n">experiment_name</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span>
                   <span class="n">resume</span><span class="p">,</span> <span class="n">output_directory</span><span class="p">):</span>
        <span class="c1"># See: ludwig/train.py</span>

    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># See: ludwig/train.py and ludwig/cli.py</span>

    <span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># See: ludwig/train.py</span>

    <span class="k">def</span> <span class="nf">train_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># See: ludwig/train.py</span>

    <span class="k">def</span> <span class="nf">train_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">progress_tracker</span><span class="p">):</span>
        <span class="c1"># See: ludwig/models/model.py</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># See: ludwig/predict.py and ludwig/cli.py</span>

    <span class="k">def</span> <span class="nf">predict_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_stats</span><span class="p">):</span>
        <span class="c1"># See: ludwig/predict.py</span>

    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># See: ludwig/test.py and ludwig/cli.py</span>

    <span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># See: ludwig/visualize.py and ludwig/cli.py</span>

    <span class="k">def</span> <span class="nf">visualize_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">):</span>
        <span class="c1"># See ludwig/utils/visualization_utils.py</span>

    <span class="k">def</span> <span class="nf">serve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># See ludwig/utils/serve.py and ludwig/cli.py</span>

    <span class="k">def</span> <span class="nf">collect_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># See ludwig/collect.py and ludwig/cli.py</span>

    <span class="k">def</span> <span class="nf">collect_activations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># See ludwig/collect.py and ludwig/cli.py</span>
</code></pre></div>


<p>If your integration does not handle a particular action, you can simply remove the method, or do nothing (e.g., <code>pass</code>).</p>
<p>If you would like to add additional actions not already handled by the
above, add them to the appropriate calling location, add the
associated method to your class, and add them to this
documentation. See existing calls as a pattern to follow.</p>
<ol>
<li>In the file <code>ludwig/contribs/__init__.py</code> add an import in this pattern, using your names:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">.mycontrib</span> <span class="kn">import</span> <span class="n">MyContribution</span>
</code></pre></div>


<ol>
<li>In the file <code>ludwig/contribs/__init__.py</code> in the <code>contrib_registry["classes"]</code> dictionary, add a key/value pair where the key is your flag, and the value is your class name, like:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="n">contrib_registry</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span><span class="p">,</span>
    <span class="s2">&quot;classes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;myflag&quot;</span><span class="p">:</span> <span class="n">MyContribution</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<ol>
<li>Submit your contribution as a pull request to the Ludwig github repository.</li>
</ol>
<h2 id="style-guidelines">Style Guidelines<a class="headerlink" href="#style-guidelines" title="Permanent link">&para;</a></h2>
<p>We expect contributions to mimic existing patterns in the codebase and demonstrate good practices: the code should be concise, readable, PEP8-compliant, and conforming to 80 character line length limit.</p>
<h2 id="tests">Tests<a class="headerlink" href="#tests" title="Permanent link">&para;</a></h2>
<p>We are using <code>pytest</code> to run tests.
To install all the required dependencies for testing, please do <code>pip install ludwig[test]</code>.
Current test coverage is limited to several integration tests which ensure end-to-end functionality but we are planning to expand it.</p>
<h3 id="checklist">Checklist<a class="headerlink" href="#checklist" title="Permanent link">&para;</a></h3>
<p>Before running tests, make sure 
1. Your environment is properly setup.
2. You have write access on the machine. Some of the tests require saving data to disk.</p>
<h3 id="running-tests">Running tests<a class="headerlink" href="#running-tests" title="Permanent link">&para;</a></h3>
<p>To run all tests, just run
<code>python -m pytest</code> from the ludwig root directory.
Note that you don't need to have ludwig module installed and in this case
code change will take effect immediately.</p>
<p>To run a single test, run</p>
<div class="codehilite"><pre><span></span><code>python -m pytest path_to_filename -k &quot;test_method_name&quot;
</code></pre></div>


<h3 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code>python -m pytest tests/integration_tests/test_experiment.py -k &quot;test_visual_question_answering&quot;
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        

<!-- Application footer -->
<footer class="md-footer">

    <!-- Link to previous and/or next page -->
    
    <div class="md-footer-nav">
        <nav aria-label="Footer"
             class="md-footer-nav__inner md-grid">
            
            <a class="md-footer-nav__link md-footer-nav__link--prev"
               href="../user_guide/" rel="prev"
               title="User Guide">
                <div class="md-footer-nav__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
                </div>
                <div class="md-footer-nav__title">
                    <div class="md-ellipsis">
                 <span class="md-footer-nav__direction">
                   Previous
                 </span>
                        User Guide
                    </div>
                </div>
            </a>
            
            
            <a class="md-footer-nav__link md-footer-nav__link--next"
               href="../api/LudwigModel/" rel="next"
               title="LudwigModel">
                <div class="md-footer-nav__title">
                    <div class="md-ellipsis">
                 <span class="md-footer-nav__direction">
                   Next
                 </span>
                        LudwigModel
                    </div>
                </div>
                <div class="md-footer-nav__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
                </div>
            </a>
            
        </nav>
    </div>
    

    <!-- Further information -->
    <div class="md-footer-meta md-typeset">
        <div class="md-footer-meta__inner md-grid">

            <!-- Copyright and theme information -->
            <div class="md-footer-copyright">
                <div class="footer-logo-smallpad"></div>
                
                <div class="md-footer-copyright__highlight">
                    Copyright &copy; 2018 - 2020 Uber Technologies Inc.
                </div>
                
                Website by <a href="http://w4nderlu.st">w4nderlust</a> powered by
                <a href="https://www.mkdocs.org">MkDocs</a>,
                <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a>,
                <a href="http://www.styleshout.com/">styleshout</a> and
                <a href="http://cables.gl/">cables</a>.
            </div>

            <!-- Social links -->
            
            
            
        </div>
    </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>